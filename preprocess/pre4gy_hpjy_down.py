# encoding: utf-8
import os
import json
import pandas as pd
import numpy as np
import pickle
import glob
from datetime import datetime
from tqdm import tqdm
from multiprocessing import Pool
import time
import re
import copy
from sklearn.preprocessing import LabelEncoder, MinMaxScaler

def get_down_file(file, emb_file, tgt_file):
    # in downstream dataset, select imei with embs
    df = pd.read_csv(file, sep='\t', dtype=str)
    df_emb = pd.read_csv(emb_file, dtype=str)
    print("down user: {}, user with embs: {}".format(len(df), len(df_emb)))
    if "dayno" in df_emb.columns:
        df_out = pd.merge(df, df_emb, how="left", on=["imei", "dayno"])
    else:
        print("forecast")
        df_out = pd.merge(df, df_emb, how="left", on="imei")
    print("same user: {}".format(len(df_out)))
    df_out.to_csv(tgt_file, sep='\t', index=False)


def get_down_file_big(file, emb_file, tgt_file):
    # in downstream dataset, select imei with embs
    reader = pd.read_csv(file, sep='\t', dtype=str, chunksize=500000)
    df_emb = pd.read_csv(emb_file, dtype=str)
    df_out = pd.DataFrame()
    print("user with embs: {}".format(len(df_emb)))

    for df in tqdm(reader):
        df_tmp = pd.merge(df, df_emb, how="left", on="imei")
        df_out = pd.concat([df_out, df_tmp])
    print("same user: {}".format(len(df_out)))
    df_out.to_csv(tgt_file, sep='\t', index=False)


def get_down_file_cat(file, emb_file, tgt_file):
    # in downstream dataset, select imei with embs
    df = pd.read_csv(file, sep='\t', dtype=str)
    df_emb = pd.read_csv(emb_file, dtype=str)
    df_emb = df_emb.rename(columns={str(i) : "e_" + str(i) for i in range(64)})
    print("down user: {}, user with embs: {}".format(len(df), len(df_emb)))
    if "dayno" in df_emb.columns:
        df_out = pd.merge(df, df_emb, how="left", on=["imei", "dayno"])
    else:
        print("forecast")
        df_out = pd.merge(df, df_emb, how="left", on="imei")
    print("same user: {}".format(len(df_out)))
    df_out.to_csv(tgt_file, sep='\t', index=False)


def get_down_file_big_cat(file, emb_file, tgt_file):
    # in downstream dataset, select imei with embs
    reader = pd.read_csv(file, sep='\t', dtype=str, chunksize=200000)
    df_emb = pd.read_csv(emb_file, dtype=str)
    df_emb = df_emb.rename(columns={str(i) : "e_" + str(i) for i in range(64)})
    df_out = pd.DataFrame()
    print("user with embs: {}".format(len(df_emb)))

    for df in tqdm(reader):
        df_tmp = pd.merge(df, df_emb, how="left", on="imei")
        df_out = pd.concat([df_out, df_tmp])
    print("same user: {}".format(len(df_out)))
    df_out.to_csv(tgt_file, sep='\t', index=False)


def drop_duplicates_imeis(file, dup_set):
    # drop imeis that use multi models
    reader = pd.read_csv(file, sep='\t', dtype=str, chunksize=500000)
    len1 = 0
    out_df = pd.DataFrame()
    for df in tqdm(reader):
        len1 += len(df)
        df.drop(df[df['imei'].isin(list(dup_set))].index[0], inplace=True)
        out_df = pd.concat([out_df, df])
    print("file: {}, before: {}, after: {}".format(file, len1, len(out_df)))
    out_df.to_csv(file[:-4] + "_clean.csv", sep='\t', index=False)


def drop_duplicates_imeis_train(file, dup_sets):
    # drop imeis that use multi models
    df = pd.read_csv(file, sep='\t', dtype=str)
    len1 = len(df)
    out_df = pd.DataFrame()
    for i in tqdm(range(len(dup_sets))):
        date = "2023030" + str(i+1)
        df_tmp = df[df['dayno']==date]
        df_tmp.drop(df_tmp[df_tmp['imei'].isin(list(dup_sets[i]))].index[0], inplace=True)
        out_df = pd.concat([out_df, df_tmp])
    print("file: {}, before: {}, after: {}".format(file, len1, len(out_df)))
    df.to_csv(file[:-4] + "_clean.csv", sep='\t', index=False)


def get_imei_label(file, tgt_file):
    # select imei, label from downstream files
    df = pd.read_csv(file, sep='\t', dtype=str, usecols=["imei", "label"])
    df.to_csv(tgt_file, index=False)



if __name__=="__main__":
    # for gy
    # forecast_file = "/home/notebook/data/group/old_game_operation/game_backflow_gy_imei_forecast_pinfeature.csv"
    # train_file = "/home/notebook/data/group/old_game_operation/game_backflow_gy_imei_train_pinfeature.csv"
    # emb_train_file = "/home/notebook/data/group/app-series/pretrain_game/gy_open/imei_embs_sum_last_train.csv"
    # emb_fore_file = "/home/notebook/data/group/app-series/pretrain_game/gy_open/imei_embs_sum_last_forecast.csv"
    # out_train_file = "/home/notebook/data/group/app-series/pretrain_game/gy_open/down_train_all.csv"
    # out_fore_file = "/home/notebook/data/group/app-series/pretrain_game/gy_open/down_forecast_all.csv"

    # ae_train_file = "/home/notebook/data/group/app-series/pretrain_game/gy_open/imei_embs_ae_last_train.csv"
    # ae_fore_file = "/home/notebook/data/group/app-series/pretrain_game/gy_open/imei_embs_ae_last_forecast.csv"
    # out_cat_file1 = "/home/notebook/data/group/app-series/pretrain_game/gy_open/down_train_cat.csv"
    # out_cat_file2 = "/home/notebook/data/group/app-series/pretrain_game/gy_open/down_forecast_cat.csv"

    # for hpjy
    forecast_file = "/home/notebook/data/group/old_game_operation/game_backflow_hpjy_imei_forecast_pinfeature.csv"
    train_file = "/home/notebook/data/group/old_game_operation/game_backflow_hpjy_imei_train_pinfeature.csv"
    emb_train_file = "/home/notebook/data/group/app-series/pretrain_game/hpjy_open/imei_embs_sum_last_train.csv"
    emb_fore_file = "/home/notebook/data/group/app-series/pretrain_game/hpjy_open/imei_embs_sum_last_0300.csv"
    out_train_file = "/home/notebook/data/group/app-series/pretrain_game/hpjy_open/down_train_all.csv"
    out_fore_file = "/home/notebook/data/group/app-series/pretrain_game/hpjy_open/down_forecast_all.csv"

    # ae_train_file = "/home/notebook/data/group/app-series/pretrain_game/hpjy_open/imei_embs_ae_last_train.csv"
    # ae_fore_file = "/home/notebook/data/group/app-series/pretrain_game/hpjy_open/imei_embs_ae_last_0300.csv"
    # out_cat_file1 = "/home/notebook/data/group/app-series/pretrain_game/hpjy_open/down_train_cat.csv"
    # out_cat_file2 = "/home/notebook/data/group/app-series/pretrain_game/hpjy_open/down_forecast_cat.csv"

    get_down_file(train_file, emb_train_file, out_train_file)
    get_down_file_big(forecast_file, emb_fore_file, out_fore_file)
    # get_down_file_cat(out_train_file, ae_train_file, out_cat_file1)
    # get_down_file_big_cat(out_fore_file, ae_fore_file, out_cat_file2)

    # NOTE drop error imeis
    # hpjy_forecast_dup_imeis = {'863892036480958', '869752036620272', '864295037791994', '864313034757759', '865632034504294', '864156043483853', '869761036958434', '860771047513358', '866922040467217', '865280038934552', '863322042333173', '863801062698615', '868584043750938', '866510036902113', '867568040442038', '868377032487194', '868122038535996', '865540048134570', '861258035084955', '862782051562254', '860318049408235', '864099035992392', '863322040212650', '865063043093071', '868902032756130', '862166045469299', '863681036768318', '865363037170277', '869466036030792', '863892032205011', '863801069297213', '867675031190219', '867266043134617', '868060034711239', '864328034097733', '865746033502974', '864523047148735', '867475035279237', '863062031704055', '864324034139930', '866984049591371', '867559046911530', '868473051911071', '863166069973316', '869762031705911', '863912030089157', '864156043427074', '860116059606536', '868166046874533', '864523043441373', '865628036832915', '861602038673670', '867580040735832', '866652053435278', '860890058770135', '860284054646319', '865885034866358', '863892035820899', '866011032368912', '861404032866834', '867675031919377', '869608052471794', '869324038635672', '866189033090733', '864259037697478', '860143049786210', '863511045651793', '861507047006194', '861560048165055', '860887049056137', '868821030918890', '860340040840539', '866027064465855', '865366034829779', '863703044141153', '869762039684076', '868272047733510', '869368034788878', '862531031259618', '865856049348773', '865838042253697', '863964058023170', '862435050366116', '865924048864578', '869466036038076', '869844064591416', '861730031657430', '868841048356495', '865838046336555', '867475039496639', '863892034084877', '865838042223070', '860321069937851', '860224059043237', '865063043026139', '863892039921370', '866193038238578', '865985044328132', '861602034279613', '866503034394771', '868642033636218', '866019034129216', '868061034606452', '865924048817311', '864072035898794', '865985042397311', '868788040658933', '860318045657215', '866021038167911', '860143045917579', '861010055145897', '865102058269133', '867465036103437', '862352049531579', '866019036072273', '865366037553558', '869745038889374', '864523047171612', '869754038690154', '864326036766958', '867568040452078', '863256040713699', '863846069789610', '861105059792114', '860470044786659', '866019032097134', '862607040836974', '860340040891599', '868061038849694', '864416032517990', '862166045426992', '864294044585671', '865363031968650', '868681054488919', '866510038577335', '860318048211515', '864079035699833', '860879054534611', '868894038703192', '863363039717358', '868380033506418', '860741047179773', '864371043253830', '869596041118933', '863189035862058', '863511040356877', '865924048846518', '864156043478390', '866652057565799', '864080037496137', '865628038928372', '864412031839436', '864774044046915', '866727069931716', '866176034542994', '865649038410070', '865366031344293', '865540045394359', '865649031899311', '868380030966656', '860073069881775', '866027063143198', '862784033142130', '862949032821279', '867568040441790', '869844068023937', '865405042370697', '863892032034015', '866017036030556', '860340041731752', '868639035268792', '869762036025778', '861504037555454', '869754033654296', '867675036285931', '865628033655459', '860073069943831', '861507044427518', '863856059293432', '860408052709379', '869757031045474', '864156043423313', '862966038574314', '866187037942990', '863668045690831', '869192050076012', '869752034236550', '865747039470711', '862639055441317', '862006049862810', '863892035581939', '864806038325176', '861742034771811', '860525049892396', '863670035329131', '866825041540355', '869197036437279', '863906032406690', '863910038317174', '863439033353497', '863322042329916', '866617036086019', '864071031338573', '868166047771258', '868065033309877', '860172044527675', '866189031860558', '863892038769739', '866379035134478', '868052030705372', '869756033582492', '864258037026811', '864067031445657', '867559046932593', '860879054332537', '869761031553610', '869744035814279', '861916033645297', '867675036475599', '862183056652473', '869308030364795', '869466036076977', '868061032351218', '863173040157332', '863570051959615', '864099036402474', '862782051562593', '864313034031197', '866520036887719', '868166048543250', '869315058564610', '862166045466196', '860073069836118', '860073069934392', '869744033163752', '868894031596270', '865463035651433', '862017036349059', '861010059936853', '866922042262319', '863438037381892', '866922043746294', '863892037758154', '863575044242136', '865043059513816', '865924048835115', '869163036519292', '860365059970554', '861597068728099', '861464039550336', '869757036915291', '865628030733572', '865649037741798', '866173037792916', '867674033938816', '865746031346838', '864811045727851', '868413053577017', '863322042392831', '865130039506794', '869368031268692', '866322046722592', '862797057923615', '869802058313957', '865741049307252', '869218046444616', '863892035658976', '862234047027935', '864074038016895', '868377033846133', '868737047453616', '862607041277517', '865996047526879', '868166047764410', '866922043429370', '865403056151632', '863892037427792', '865746030179057', '867132035506917', '862535053008878', '864325038599656', '868047036364018', '865280039038635', '869117039593217', '868272045604416', '861079035913559', '867461033824414', '869173033692919', '860421056079350', '865628030731436', '868401035767038', '862183035460238', '869368032269590', '869758038653831', '864071033905957', '866510038404290', '869752036688337', '865261056549035', '861560046901717', '865746038574192', '865649036688396', '867190053452398', '860470045419953', '862526031458459', '866017038511355', '862807043496517', '868584043756075', '867462037691932', '868894031892638', '865463030354231', '868895039626035', '868858044398073', '868066036188292', '863581049367431', '863782047353494', '866296037323158', '868821036738573', '862903042727992', '864295033734295', '867409049340339', '866699043055153', '866914037798613', '862532038734397', '865985042428694', '863892030077891', '864322031705216', '864337038819935', '860200042279054', '864395033898734', '864523047191677', '868561040842876', '867674034153670', '869317030965196', '862903046194116', '860165049290174', '866564049768078', '867568040430413', '868584041259916', '863668046860797', '862962033543511', '867465035409199', '867568040480053', '866171030972139', '865366030169253', '860741047179617', '866510038787710', '862532034100775', '863049033329676', '868240054803716', '863322044562878', '866256049042477', '860879051746630', '867836048358773', '862531031805956', '868644034609418', '865363033147618', '865277033170950', '862204049010577', '865132035814719', '866186039878335', '869318038597916', '867559046970916', '865856043553816', '869163039966714', '863892038472797', '868240053153170', '869368031704779', '865906043555996', '869368032785835', '863048039885673', '868913037756157', '865838042243318', '864282044304557', '869326034005677', '862253059343014', '869762039219899', '866652059416496', '866865046483979', '866186034257394', '863330041999993', '865748039929755', '860182040768850', '868047036550392', '860072048334633', '869368039479879', '867764042131915', '869608054644893', '862531031020093', '861557051145818', '863182030472171', '869608058009432', '864313035424433', '861742033711917', '869744031450714', '865747036373751', '866803045250933', '866177036352358', '861441047624634', '866379035949719', '860073069919435', '869754030759817', '865043058487178', '860072048380974', '866520038793634', '865540048590953', '865277030121139', '866172031961717', '863698036135959', '866019034137573', '862096033047379', '863388038058850', '863505037747155', '866322041679615', '864067031505138', '864101046771532', '866617032313078', '864935050307513', '869166036312139', '869440052235296', '869744035318552', '869762033024857', '860528057402579', '867285050389534', '867469036383379', '861448054956478', '866018031517936', '863892035081278', '869318038269391', '866100050474676', '862782056504319', '868473058019217', '864156043483614', '865924048882653', '864499044835238', '866379030113550', '863383069930994', '862639056544291', '864314031427370', '866922042467892', '864935059059636', '866705069928411', '864413033305657', '864555041523117', '864413034628917', '866703037170273', '862352049727938', '862166045415110', '865746030805610', '864523047113853', '867852050880331', '866016039372999', '864240032789999', '865385048625692', '867132031159596', '869596042746070', '862022032126956', '860676057923936', '869608056141898', '865985043905575', '868377031277992', '866652053011277', '864414039416993', '864121069839495', '863322043700677', '864322035236499', '867947049869856', '865054048328679', '860161059315993', '865363034935458', '864785059289679', '868377033481816', '866510030446752', '860340041771295', '868841043595196', '862166045484611', '866013037832173', '867764048199395', '869314044226418', '863670036188858', '862783032068833', '866021037782975', '862961036487676', '862166048511576', '867947041977194', '869369037203170', '864523047181058', '868681056638578', '869166039012413', '865924048852912', '864803037873512', '868064038088412', '864322031805057', '863892034880076', '864297031936799', '860310047980299', '860200045594558', '865463034798094', '868380036980958', '867675031051890', '866521036662953', '865924043106231', '869762037061319', '865134041663791', '866019034319916', '866511038526397', '864853041099034', '866922044516977', '868821032827933', '860391040100853', '866394055005599', '866605046405493', '865385048683295', '868610059013851', '862531031286595', '865628034214116', '863330049922856', '866379032932791', '863668046174819', '860318048238914', '863903035380030', '862554051049677'}
    # hpjy_train_dup_imeis = [{'863050037765436', '860143042016714', '863131044429917', '869802059580893', '863894068581497', '866013035517172', '867674033938816', '869756032916295', '860284056845356', '865683052409890', '861743034265838', '860741047143456', '860073069876031', '863505036092736', '867559046911530', '868894031545491', '867676037565214', '864395033631739', '867525058326578', '868385039902990', '866727069897875', '866703030549937', '866108047782911', '863892039736216', '866511032871492', '863383069871537', '865741048282332', '864329031661752', '868784052084035', '860596059699856', '865795042601376', '861459041885332', '866922040918318', '864297030149295', '864413037002250', '863438035127313'}, {'860596059672994', '866322042280736', '863383069924757', '869761034096237', '860408050808355', '867094047273276', '869024052407293', '865310053223217', '866021038167911', '866172056961899', '863912033764434', '860318045350233', '865130031487472', '863322048268910', '863505037270018', '863446064072839', '861563058879292', '864081032907854', '868166047721733', '867094047236331', '860741049748351', '866914037798613', '866727069887678', '866394055614754', '868901035870559', '868060036845431', '864774048065150', '866922043409034'}, {'866411049771076', '867448068414195', '863678032118712', '868166048640478', '862531038835436', '861088046433697', '865683052409890', '861463036830154', '865985041398153', '866107049304815', '863363039654759', '861010052936074', '866378030397494', '865463031138534', '869762039684076', '866727069845999', '866186039874995', '868637032824112', '866914038797978', '869824058443071', '860073069835631', '868332056394859', '869753039156058', '861573048504579', '863912035159377', '861179057438533', '869762039399774', '863891033926898', '869747032586493', '864523043441373', '863698033763639', '867278040104733', '867568040487918', '865649039885213', '868914031649612', '865628038874394', '861507047884731', '864327034180077', '866727069887678', '860887043536035', '866017036280318', '866521039375835', '867947043352537', '863322044873770', '869166039012413', '860025048933150', '865273047639551', '865838042223070', '864774044813736'}, {'861226055788896', '864101040922990', '869310037853135', '868047039854114', '868690054031876', '867559046966252', '865200056760739', '865956053165236', '861309039563690', '869747034233995', '868072047122635', '860073069844237', '868166047748132', '869608056536675', '861441047624634', '862352041749690', '867593058466133', '864297030149295', '869315058717937', '866295038284799', '869466036097593', '864101044638592', '865856046717673', '868784052816592', '866704048868178', '865282031235177', '863892037750136', '862287042959056', '864320033707073', '869368032757719', '867679039294973', '865748035427531', '869608059197756', '860340041223115', '864327034179970', '867461033259918', '868645032768635', '868060036171952', '869776048003474', '866194036472573', '860741049748351', '869163036137517', '866843046898256', '867674035167190', '866504037106238', '863363035377678', '869749035198516', '863892035645916', '867094047291518', '864331036575219', '868065033309877', '869547052246139', '867871043264296', '863801067797537', '863892037748254', '861010058069557', '865649035125051', '863505038942714', '860143042204278', '869166034707918', '862604035689336', '866865047586572', '866922048408874', '860340040854332', '860072048311813', '865924048864578', '867155052036211', '868639036398259', '861573048226397', '864371049052533', '860165049286230', '863912037392950', '868644034866778', '862532032574351', '860200045548810', '869320035952011', '869744030745791', '869987050546199', '864556035896816', '864811044277270', '860140056271672', '860200040636636', '864101049116438', '869368033688178', '860924058475856', '866379037505790', '864661046257535', '863681032523097', '865385048683295', '865363035614912', '867575064179230', '869330057265812', '868166042869651', '866193033734811', '863912031863774', '869752038651333', '867961033472890', '861597068728099'}, {'868639030530170', '867461035756853', '869749038591451', '864555042619013', '863466037835674', '860143040294255', '865985048691436', '861742034174156', '867475030600775', '864324032202219', '868584043775299', '865366039141410', '865345052719377', '865628039553690', '863846069836551', '864523043491378', '868119049519332', '866019034466550', '860056055628557', '869608052844099', '863892039240599', '864246031673373', '866295034578475', '864101042763871', '863684034470614', '865924047328237', '866296036585591', '864313035083635', '864101049803134', '865649033611151', '861602038673670', '866928041952735', '866922042191013', '865007047418198', '867121069400113', '869368031694772', '866295032763970', '863671031088358', '869762034743711', '866564049768078', '862531036084839', '868639038623712', '867525058326578', '869368034788878', '867559046913254', '864083033086852', '866703036292771', '868707050239350', '868913032843034', '863038056866797', '868638032895433', '860079041048078', '866916038069977', '864371043880350', '867568040415117', '860072048353591', '868429057614077', '861597066360671', '866186039874516', '862590047492217', '863219055201778', '864331038647677', '869756038266992', '868380031559179', '865071059878277', '865985041623832', '867094047245373', '861443031067994', '863322049671211', '861573047278910', '866189039482934', '865628032493571', '860025048213231', '866511038091376', '862021030113495', '862467031799933', '868401032349459', '860778038541454', '868644032477214', '861441041822390', '868821035102094', '869752034275418', '860182044199532', '860056053323813', '864096033349799'}, {'862166045424070', '866019036337890', '862097034938178', '864099036402474', '865277035554078', '863678032118712', '869759038091774', '869761036958434', '866581044732057', '866922046569792', '863905031735455', '866511036848991', '867559046966252', '866018031749398', '863892033069416', '865540048134570', '864806032361193', '863801068329553', '860750038119110', '860321069900511', '867467055553252', '865132067831896', '861602037382430', '865366030169253', '861602038673670', '869752036664619', '867190052295798', '866019034907553', '866170032159018', '868166047788674', '864329031810110', '866174031664531', '864156043449599', '868584043794555', '865906040425557', '865924042081039', '866189032101457'}, {'860379040740497', '866296036935994', '861563058561593', '865856042598259', '866015038756152', '864322031805057', '861661058834851', '867559046951239', '866019030925674', '864335032430915', '864156043416390', '868377031277992', '860073069842074', '861259035244110', '866379031078950', '861557059749892', '862535054317971', '866705069929872', '867568040423178', '868048038794855', '866672051543774', '864625049116352', '864320037565212', '866322052394955', '866379032103872', '860073069961213', '863664059677236', '868377036238619', '863438037044516', '863846069903898', '867266044573151', '860528053197033', '864806038325176', '866296038218415', '860340041743799', '865521047936777', '867675031157812', '868941045886955', '866803043026590'}]
    # # drop_duplicates_imeis("/home/notebook/data/group/app-series/pretrain_game/hpjy_open/down_forecast.csv", hpjy_forecast_dup_imeis)
    # drop_duplicates_imeis_train("/home/notebook/data/group/app-series/pretrain_game/hpjy_open/down_train.csv", hpjy_train_dup_imeis)
    
    # gy_forecast_dup_imeis = {'862166045424070', '860340040894395', '860883056143090', '861607046511838', '866922048291858', '860165049244916', '861661054282154', '866922041635192', '866922042904472', '867961035121156', '866922040467217', '862006042167951', '869368039505111', '869330057996531', '866391046224735', '860079049032777', '862639053382851', '866027066459914', '865200056760739', '860543050216736', '866018032691219', '866520035174416', '862535058410152', '863950052384718', '865130030283252', '869824058443071', '860149047536812', '866347055330458', '866511032929159', '863950056124011', '888888888888885', '869608054424635', '861010058008514', '861573048060770', '864121069893732', '864523047148032', '863131048488133', '862755044805998', '868584040644795', '862629049787584', '860887043536035', '863038054698598', '869320031008875', '869315058717937', '865906048075230', '868166047737739', '866727069817899', '861012057539150', '867667055837270', '869166033710137', '866538047686854', '864156040810298', '868377030099892', '865758059036613', '868304056649053', '862543054371451', '869118036017234', '860299049119453', '866922042459832', '861507047845930', '864156043441356', '866019036339094', '866922048539637', '868473051911071', '868639038675175', '866193034325155', '868377034135635', '866703038872554', '869315053566271', '862328054513470', '866652058330219', '861573049343977', '862543055573196', '868304059909918', '868166046874533', '860318047450734', '864156043477012', '864101043279711', '861010055041617', '869315057038095', '863559066185258', '868272048164236', '866379031069074', '862613052352454', '860837057251237', '863936061165735', '865906045321819', '869368033553059', '863570057721456', '866843046898256', '863207058995975', '864935057143077', '867121069400113', '860741047114051', '864972058467957', '860318046293879', '865063043062779', '863511045651793', '868821039493051', '866027065185932', '868821031942972', '861907056986890', '869422052755952', '868377031251138', '860340040840539', '866193033458759', '863703044141153', '869097036706055', '864222044860513', '868122038618651', '869097034535779', '869368036485192', '867135047667213', '865856049348773', '869608053518874', '865063043045790', '865054047894598', '863801064520395', '868286051907935', '862755042479291', '865924048864578', '865985041385598', '862435052657892', '868286056179274', '865007047523534', '865463036593436', '863322042348056', '860465056480993', '863856053678711', '863809056938178', '864371043880350', '868429057614077', '863207055867037', '866564049729658', '865063043026139', '866193038238578', '866922046790471', '868061031332672', '866018033618674', '869745069170595', '867525056630039', '862287043862036', '866019034129216', '866018030026632', '866511036002938', '867094047289132', '867889069156790', '863801067205630', '866922042023216', '860771048831056', '866922043418951', '862940045790213', '866699045692870', '864811044277270', '867559046990054', '865385048615313', '867465036103437', '865838042286853', '869368030597653', '866521033719152', '863322046001891', '864156043450977', '866411049784376', '866699045752872', '868072041953696', '866927057662410', '867467055133972', '865683050761896', '866411049763255', '868240055561131', '866379038539251', '862234047554318', '866508037474413', '866564049731597', '860340041731299', '869758031492153', '868941049679539', '866825047156115', '860340040891599', '868272049388750', '867190055416011', '868639035300157', '860340040824574', '864425044290272', '867675037519858', '861226055788896', '865063041004195', '868072044032332', '861441046043711', '868304059262870', '860310049103254', '867764043799850', '865683052409890', '865924048876614', '862087135462087', '866922046233654', '868304053267537', '860071054612098', '862287049385099', '869987052455811', '869758033389498', '865985048691436', '868166047763552', '864853049460634', '864553030240595', '860318047091652', '861885059470874', '864853045522650', '862435051957434', '864777045468558', '868288056781117', '868304059678174', '869118034982132', '865345052719377', '869761037318356', '866107048999433', '865007042673631', '866913036171111', '868166047777073', '861377041941337', '863713058045778', '860045056832656', '869197033992656', '869898067146859', '867593058466133', '867465031030973', '866015037501211', '864771047876918', '864314042304113', '868185054867296', '862287045933371', '862006046707174', '863703043474399', '860340041727917', '867874047903299', '865405042370697', '868426058922137', '863953049422112', '864820058463338', '866581044732057', '862328052047414', '866703033140254', '866917030925893', '863383046965931', '867190058294878', '869466036054453', '865310053223217', '863383069896054', '866522035116835', '864546061421639', '869454048074990', '863003058404450', '865924047328237', '860056057418551', '866411049745377', '868380032294099', '867278048801611', '865924048872779', '866564049765678', '868061039412211', '869761031950816', '863801066268217', '862006049862810', '868272048129353', '866564049746736', '864461058024356', '868064038877913', '862287048718696', '869317033852193', '862350055395095', '866703030864351', '863703046543091', '867282054802497', '862287040370439', '860379040740497', '866825041540355', '865985045652217', '867465036164637', '860525043450597', '869761034096237', '865463031714755', '862180040237510', '869202047719218', '866508037375776', '868272045444755', '865924043753677', '869289048250814', '865071059919550', '864523043451976', '868065033309877', '869163036645295', '868166047766357', '866018031729614', '869761031756353', '860543053833610', '866193035563853', '866918037748932', '862234047943610', '864156041024071', '860340040854332', '860318045345019', '868681055510471', '862253056277694', '864853041631794', '868941043572615', '867672050196599', '866018031573434', '866699041872732', '866510039059093', '868122034352511', '866922049422551', '861010055208950', '860408053046755', '866108043345697', '868007050410253', '862183054121174', '861459046093577', '863173040157332', '866193034335550', '868185057605859', '869326069961299', '866581045092071', '867679037355255', '869315058564610', '862404058566770', '860165049221575', '869761034624673', '865924048580711', '866379031078950', '866510031347991', '864282047031991', '861889042232458', '866927051442579', '867155053791814', '866107041003613', '866100056035596', '865906045771872', '867961037322836', '866984042928315', '861907056696077', '864523043491394', '869312038296876', '866322047331690', '868631041340319', '866019031629275', '862928048764210', '869368030253356', '864556033968195', '866018032112216', '866107049103696', '864523047167834', '868272045256332', '866378030109451', '860741047182231', '868072044171593', '868607047270635', '866296039328494', '868607042406978', '865071059909551', '869326067458413', '860143042016714', '866100051864917', '867947047713338', '866379031665517', '867674033938816', '865132067215298', '862180049615393', '862287047505219', '865054046551538', '862797057923615', '863782043216117', '864186050352931', '866922040195933', '869824058007173', '861573048995678', '864092054710837', '860810046873270', '869318032052355', '869762030950971', '865924040740990', '863131041110890', '868072047122635', '868737047453616', '862807047961631', '864661041984752', '860883056549395', '863668046762910', '869289047819890', '865906043516576', '868230050085491', '861631051944411', '865403056151632', '864974056538433', '863136048987117', '868584043781933', '864101041299190', '865403051049476', '867667058471697', '865385048642911', '866411049747530', '866520036183390', '860340041718114', '864777044392973', '863322042363535', '868377039463974', '868377034460819', '866922042486637', '861573048043636', '867608056370374', '862782058995598', '867094047275818', '866322046624459', '864523042050712', '866564049780271', '863801063284456', '867339049009636', '867679039294973', '869097036413355', '866564043796695', '868473053843652', '869755036417375', '867672056216953', '865463036670754', '860340041223115', '868377030259470', '860200048934918', '866017039603912', '866017030932138', '861889047033893', '866510039911798', '866922049358193', '860210040666756', '865856047983977', '866379038077716', '869192054158832', '860365054643578', '869309036415250', '860077054025439', '863575044201652', '860903051062416', '866914037798613', '865906046445195', '860741047169535', '864371045629813', '868858043213836', '866379038389335', '355775030002578', '860525043486351', '862204048776350', '861507041833155', '863570052066717', '864556037182496', '864337038819935', '868584043790157', '866019033897474', '868166047747415', '867094047227892', '866322043763912', '867315043850613', '866296033946333', '860318043700975', '865906044006510', '867667057560797', '867559046913676', '861088047951515', '862903046194116', '866018036504772', '865743053163811', '869761039533812', '869776049368538', '866564049768078', '860072048371015', '868240054858215', '862166045469430', '864972050621890', '866510036067057', '865063043050816', '867465035409199', '866017038620792', '866509032173174', '867443044116774', '869173030088053', '865200057475592', '869163032596997', '866865043154912', '868166047794052', '865985047027939', '866703033423213', '868166047635990', '865924048854777', '866865047586572', '863322049607330', '868122037753657', '861607043794031', '861507047884731', '861010057921212', '867947043352537', '866108043350333', '868681052420112', '866322044335553', '865749035247630', '866922041669076', '868166047785498', '863950059317059', '862006042891758', '862782052116431', '868639036474597', '864376026015007', '865603041254496', '866564049767013', '861661058834851', '862928045305777', '860340041793158', '865063043017237', '860200045548810', '861573046275537', '861507049721618', '864092059240079', '864820055722314', '865924048870690', '863801068682357', '864777048008435', '867675031695738', '866108048915999', '862755040197614', '868240053153170', '863570055861379', '865463035064371', '865385048696859', '868584043718752', '868166047787791', '000000000000000', '864156043444533', '864661046257535', '866922040935239', '865924042374376', '869572040068759', '866520037806635', '868166047788559', '869289046681911', '863570053002737', '860072043119658', '862328051896399', '860340041776054', '864972055240357', '866017032017938', '864156043485973', '865956052441158', '865162050759812', '865838042255171', '865924048873355', '866922047162514', '866652058674574', '866379030306154', '866511038339932', '860887042224674', '869759037011690', '865200059278432', '860072048334633', '867464038460010', '860887042225713', '864625040847211', '861757069904236', '869173032044997', '867675031966154', '868272045642556', '865750035653157', '869776048989177', '866564049741497', '862166045482698', '869368033163412', '862166045493315', '866295033302034', '866506034880756', '868272042925095', '864486056748417', '868377036572959', '860200043325476', '868380034418738', '863322043814197', '863703048680693', '866295037188074', '869466031860458', '864853041725299', '865385048647894', '860045054757855', '867961039953174', '868066035351297', '861459041885332', '860072048380974', '869454048824790', '866917032963991', '867282050364559', '861441048963676', '865540048590953', '866322054647632', '866564049715350', '869173034136452', '866922043409034', '868681055551830', '869118033392176', '866379030379912', '863511047241478', '862328055358297', '812345678912343', '861563058561593', '865838042278397', '868166047756358', '866520031174352', '862350050711510', '863664057544958', '869315057228878', '869466034569890', '863664052347274', '865924048859156', '864935050307513', '866984047465131', '869320031104575', '866108047176759', '860528057402579', '865315052594955', '862287047045190', '863145050499937', '865534043469818', '865956059625118', '865838042241858', '860364047578694', '863953049031772', '863950058720477', '865924048864651', '862699055798314', '864101042763871', '864523043426259', '864156043477319', '868286054137274', '860470045768979', '861313041172912', '866100050474676', '862782056504319', '865025047058715', '868060036171952', '864101049803134', '863511049799218', '868272045211832', '864499046306493', '864499044835238', '865463032518171', '866379030113550', '865063043018672', '866174035620091', '865838042242450', '867278049799178', '865025049091615', '863809059314930', '867155053801373', '865838042296373', '868377034807894', '865385048647910', '864523047113853', '864523043485750', '867674034097851', '861573049032554', '864523043432554', '867764046129832', '868166047751250', '866672052965117', '865403053839155', '864222041410213', '868821030076251', '863826051488157', '868227041248253', '864778059112157', '812345678912344', '863322042396956', '864121069839495', '868007059143012', '863950058540917', '865924048816891', '865063043045253', '868584043760051', '868377033734016', '866322054484176', '864680040335956', '868061034371537', '863322046304691', '860310041148232', '864853041318913', '860340041771295', '860538056176538', '866546043948111', '869368033432775', '869608059094755', '867094047216754', '861010059182094', '860045058668231', '866703031539333', '862782052938230', '864556033653854', '865967053857532', '867155052036211', '864523043482914', '866702034757777', '864121069897899', '866411049777818', '863801062562837', '868681056638578', '868894038669773', '864589042821030', '866379036725290', '869761038836810', '869762039468694', '869755037719092', '863713056226974', '860165049243132', '866296037746796', '863575048522491', '860665042179290', '865856046289616', '866019038858174', '869608058968439', '869776045608333', '866378034217037', '860056051879519', '865906042961757', '867961030267897', '868048037270196', '862006048788750', '865924042055611', '868272048038133', '869608055602114', '863801061947872', '869202049313598', '863575044328653', '861691058458435', '865405040697810', '866014035325996', '865025043896175', '863322042373955', '864556035896816', '863330045666176', '866019039388510', '869608053832994', '866581040710636', '868166047798210', '868941044068654', '866193038615635', '866605046405493', '869422051857494', '865385048683295', '869317032095612', '863801063191792', '866919032517215', '868633037301396', '865924049545770', '866984048555351', '860073069895791', '860365058328218', '864972057554433', '866295034385012', '860165049216799'}
    # gy_train_dup_imeis = [{'868821039493051', '812345678912343', '864974056538433', '863131040155292', '000000000000000'}, {'812345678912343', '868858043213836', '868240053153170', '864156041024071', '864186050352931', '864371045413770', '000000000000000'}, {'861507049721618', '867465036164637', '863145050499937', '812345678912343', '862884069959538', '861661055193293', '867525056630039', '863570053002737', '868304053267537', '000000000000000'}, {'862087135462087', '865956059625118', '866652058330219', '869608053522694', '862807047961631', '860299049119453', '812345678912343', '866391046224735', '869422052755952', '867467055133972', '812345678912344', '863322046304691', '868185057605859', '864972057554433', '861607043794031', '000000000000000'}, {'865924048816891', '866520031174352', '863207055867037', '862087135462087', '868072044032332', '869422051857494', '863003058404450', '869118034982132', '869608052748654', '812345678912343', '862287048718696', '868166047769658', '866564049741497', '866296037746796', '000000000000000'}, {'812345678912343', '866922041635192', '000000000000000'}, {'868473053843652', '865063041004195', '861907056986890', '865403053839155', '860810046873270', '868166047794052', '812345678912343', '864101049803134', '863703043474399', '000000000000000'}]
    # drop_duplicates_imeis("/home/notebook/data/group/app-series/pretrain_game/gy_open/down_forecast.csv", gy_forecast_dup_imeis)
    # # drop_duplicates_imeis_train("/home/notebook/data/group/app-series/pretrain_game/gy_open/down_train.csv", gy_train_dup_imeis)

    # get_imei_label("/home/notebook/data/group/app-series/pretrain_game/hpjy_open/down_train_clean.csv", "/home/notebook/data/group/app-series/pretrain_game/hpjy_open/down_train_sample.csv")


    
    





